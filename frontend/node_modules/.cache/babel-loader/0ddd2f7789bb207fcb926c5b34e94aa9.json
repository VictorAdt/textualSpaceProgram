{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\doubl\\\\Documents\\\\Projets\\\\Try\\\\rocketbuilder\\\\frontend\\\\src\\\\components\\\\controls\\\\ShipControl.js\";\nimport React, { Component } from 'react';\nimport { ShipContext } from '../../contexts/ShipProvider';\nimport axios from 'axios';\nimport ManoeuvreControl from './ManoeuvreControl';\nexport default class ShipControl extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      ship: null,\n      stage: null,\n      celestialBody: null\n    };\n  }\n\n  componentDidUpdate() {}\n\n  async componentDidMount() {\n    this.setState({\n      ship: this.context.state.ship,\n      stage: this.context.state.stage\n    });\n\n    if (this.props.location.id) {\n      try {\n        const shiptRes = await axios({\n          method: 'GET',\n          url: `http://localhost:1337/ships/${this.props.location.id}`\n        });\n        const fetchedShip = shiptRes.data;\n        let rocketStages = []; // format data for the context\n\n        for (let i = 0; i < fetchedShip.stage.length; i++) {\n          let stage = {\n            commandModule: [],\n            engine: [],\n            tank: []\n          };\n          let currentStage = i;\n\n          for (let i = 0; i < fetchedShip.stage[currentStage].tank.length; i++) {\n            stage.tank.push(fetchedShip.stage[currentStage].tank[i].tank);\n          }\n\n          for (let i = 0; i < fetchedShip.stage[currentStage].engine.length; i++) {\n            stage.engine.push(fetchedShip.stage[currentStage].engine[i].engine);\n          }\n\n          for (let i = 0; i < fetchedShip.stage[currentStage].commandModule.length; i++) {\n            stage.commandModule.push(fetchedShip.stage[currentStage].commandModule[i].commandModule);\n          }\n\n          currentStage++;\n          rocketStages.push(stage);\n        }\n\n        console.log('rocketStages', rocketStages);\n        this.context.shipSetStage(rocketStages);\n        this.context.setShip(fetchedShip);\n        console.log('fetchedShip', fetchedShip); // Catch error\n      } catch (err) {\n        alert(err);\n      }\n\n      console.log('shipControl this.state.ship', this.state.ship);\n      console.log('shipControl this.state.stage', this.state.stage);\n      console.log('this.context.state.stage', this.context.state.stage);\n    } else {\n      // redirect to home\n      window.location.pathname = '/';\n    }\n  }\n\n  render() {\n    if (context.state.ship) return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ship__control\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ManoeuvreControl, {\n      ship: this.context.state.ship,\n      stage: this.context.state.stage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }\n    }));else return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 21\n      }\n    });\n  }\n\n}\nShipControl.contextType = ShipContext;","map":{"version":3,"sources":["C:/Users/doubl/Documents/Projets/Try/rocketbuilder/frontend/src/components/controls/ShipControl.js"],"names":["React","Component","ShipContext","axios","ManoeuvreControl","ShipControl","state","ship","stage","celestialBody","componentDidUpdate","componentDidMount","setState","context","props","location","id","shiptRes","method","url","fetchedShip","data","rocketStages","i","length","commandModule","engine","tank","currentStage","push","console","log","shipSetStage","setShip","err","alert","window","pathname","render","contextType"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,WAAT,QAA4B,6BAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AAEA,eAAe,MAAMC,WAAN,SAA0BJ,SAA1B,CAAoC;AAAA;AAAA;AAAA,SAC/CK,KAD+C,GACvC;AACJC,MAAAA,IAAI,EAAE,IADF;AAEJC,MAAAA,KAAK,EAAE,IAFH;AAGJC,MAAAA,aAAa,EAAE;AAHX,KADuC;AAAA;;AAO/CC,EAAAA,kBAAkB,GAAE,CACnB;;AAED,QAAMC,iBAAN,GAA0B;AACtB,SAAKC,QAAL,CAAc;AAACL,MAAAA,IAAI,EAAE,KAAKM,OAAL,CAAaP,KAAb,CAAmBC,IAA1B;AAAgCC,MAAAA,KAAK,EAAE,KAAKK,OAAL,CAAaP,KAAb,CAAmBE;AAA1D,KAAd;;AACA,QAAI,KAAKM,KAAL,CAAWC,QAAX,CAAoBC,EAAxB,EAA4B;AACxB,UAAI;AACA,cAAMC,QAAQ,GAAG,MAAMd,KAAK,CAAC;AACzBe,UAAAA,MAAM,EAAE,KADiB;AAEzBC,UAAAA,GAAG,EAAG,+BAA8B,KAAKL,KAAL,CAAWC,QAAX,CAAoBC,EAAG;AAFlC,SAAD,CAA5B;AAIA,cAAMI,WAAW,GAAGH,QAAQ,CAACI,IAA7B;AACA,YAAIC,YAAY,GAAG,EAAnB,CANA,CAOA;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,WAAW,CAACZ,KAAZ,CAAkBgB,MAAtC,EAA8CD,CAAC,EAA/C,EAAmD;AAC/C,cAAIf,KAAK,GAAG;AACRiB,YAAAA,aAAa,EAAE,EADP;AAERC,YAAAA,MAAM,EAAE,EAFA;AAGRC,YAAAA,IAAI,EAAE;AAHE,WAAZ;AAKA,cAAIC,YAAY,GAAGL,CAAnB;;AACA,eAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,WAAW,CAACZ,KAAZ,CAAkBoB,YAAlB,EAAgCD,IAAhC,CAAqCH,MAAzD,EAAiED,CAAC,EAAlE,EAAsE;AAClEf,YAAAA,KAAK,CAACmB,IAAN,CAAWE,IAAX,CAAgBT,WAAW,CAACZ,KAAZ,CAAkBoB,YAAlB,EAAgCD,IAAhC,CAAqCJ,CAArC,EAAwCI,IAAxD;AACH;;AACD,eAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,WAAW,CAACZ,KAAZ,CAAkBoB,YAAlB,EAAgCF,MAAhC,CAAuCF,MAA3D,EAAmED,CAAC,EAApE,EAAwE;AACpEf,YAAAA,KAAK,CAACkB,MAAN,CAAaG,IAAb,CAAkBT,WAAW,CAACZ,KAAZ,CAAkBoB,YAAlB,EAAgCF,MAAhC,CAAuCH,CAAvC,EAA0CG,MAA5D;AACH;;AACD,eAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,WAAW,CAACZ,KAAZ,CAAkBoB,YAAlB,EAAgCH,aAAhC,CAA8CD,MAAlE,EAA0ED,CAAC,EAA3E,EAA+E;AAC3Ef,YAAAA,KAAK,CAACiB,aAAN,CAAoBI,IAApB,CAAyBT,WAAW,CAACZ,KAAZ,CAAkBoB,YAAlB,EAAgCH,aAAhC,CAA8CF,CAA9C,EAAiDE,aAA1E;AACH;;AACDG,UAAAA,YAAY;AACZN,UAAAA,YAAY,CAACO,IAAb,CAAkBrB,KAAlB;AACH;;AACDsB,QAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BT,YAA5B;AAEA,aAAKT,OAAL,CAAamB,YAAb,CAA0BV,YAA1B;AACA,aAAKT,OAAL,CAAaoB,OAAb,CAAqBb,WAArB;AAEAU,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BX,WAA3B,EAhCA,CAiCJ;AACC,OAlCD,CAkCE,OAAOc,GAAP,EAAY;AACVC,QAAAA,KAAK,CAACD,GAAD,CAAL;AACH;;AACDJ,MAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2C,KAAKzB,KAAL,CAAWC,IAAtD;AACAuB,MAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ,EAA4C,KAAKzB,KAAL,CAAWE,KAAvD;AACAsB,MAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAAuC,KAAKlB,OAAL,CAAaP,KAAb,CAAmBE,KAA1D;AAEH,KA1CD,MA0CO;AACH;AACA4B,MAAAA,MAAM,CAACrB,QAAP,CAAgBsB,QAAhB,GAA2B,GAA3B;AACH;AACJ;;AAEDC,EAAAA,MAAM,GAAG;AACL,QAAGzB,OAAO,CAACP,KAAR,CAAcC,IAAjB,EACA,oBACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,gBAAD;AACI,MAAA,IAAI,EAAE,KAAKM,OAAL,CAAaP,KAAb,CAAmBC,IAD7B;AAEI,MAAA,KAAK,EAAE,KAAKM,OAAL,CAAaP,KAAb,CAAmBE,KAF9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,CADA,KASK,oBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACR;;AAvE8C;AA0EnDH,WAAW,CAACkC,WAAZ,GAA0BrC,WAA1B","sourcesContent":["import React, { Component } from 'react';\r\nimport { ShipContext } from '../../contexts/ShipProvider'\r\nimport axios from 'axios';\r\nimport ManoeuvreControl from './ManoeuvreControl';\r\n\r\nexport default class ShipControl extends Component {\r\n    state = {\r\n        ship: null,\r\n        stage: null,\r\n        celestialBody: null\r\n    }\r\n\r\n    componentDidUpdate(){\r\n    }\r\n\r\n    async componentDidMount() {\r\n        this.setState({ship: this.context.state.ship, stage: this.context.state.stage})\r\n        if (this.props.location.id) {\r\n            try {\r\n                const shiptRes = await axios({\r\n                    method: 'GET',\r\n                    url: `http://localhost:1337/ships/${this.props.location.id}`\r\n                });\r\n                const fetchedShip = shiptRes.data\r\n                let rocketStages = []\r\n                // format data for the context\r\n                for (let i = 0; i < fetchedShip.stage.length; i++) {\r\n                    let stage = {\r\n                        commandModule: [],\r\n                        engine: [],\r\n                        tank: [],\r\n                    }\r\n                    let currentStage = i\r\n                    for (let i = 0; i < fetchedShip.stage[currentStage].tank.length; i++) {\r\n                        stage.tank.push(fetchedShip.stage[currentStage].tank[i].tank)\r\n                    }\r\n                    for (let i = 0; i < fetchedShip.stage[currentStage].engine.length; i++) {\r\n                        stage.engine.push(fetchedShip.stage[currentStage].engine[i].engine)\r\n                    }\r\n                    for (let i = 0; i < fetchedShip.stage[currentStage].commandModule.length; i++) {\r\n                        stage.commandModule.push(fetchedShip.stage[currentStage].commandModule[i].commandModule)\r\n                    }\r\n                    currentStage++\r\n                    rocketStages.push(stage)\r\n                }\r\n                console.log('rocketStages', rocketStages);\r\n \r\n                this.context.shipSetStage(rocketStages)\r\n                this.context.setShip(fetchedShip)\r\n\r\n                console.log('fetchedShip', fetchedShip)\r\n            // Catch error\r\n            } catch (err) {\r\n                alert(err);\r\n            }\r\n            console.log('shipControl this.state.ship', this.state.ship)\r\n            console.log('shipControl this.state.stage', this.state.stage)\r\n            console.log('this.context.state.stage',this.context.state.stage);\r\n\r\n        } else {\r\n            // redirect to home\r\n            window.location.pathname = '/'\r\n        }\r\n    }\r\n\r\n    render() {\r\n        if(context.state.ship)\r\n        return (\r\n            <div className=\"ship__control\">\r\n                <ManoeuvreControl \r\n                    ship={this.context.state.ship}\r\n                    stage={this.context.state.stage}\r\n                />\r\n            </div>\r\n        )\r\n        else return <div></div>\r\n    }\r\n}\r\n\r\nShipControl.contextType = ShipContext;\r\n"]},"metadata":{},"sourceType":"module"}