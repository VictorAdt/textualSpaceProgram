{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\doubl\\\\Documents\\\\Projets\\\\Try\\\\rocketbuilder\\\\frontend\\\\src\\\\components\\\\controls\\\\ManoeuvreControl.js\";\nimport React, { Component } from 'react';\nimport { ShipContext } from '../../contexts/ShipProvider';\nimport { updateShip } from '../../utils/updateShip';\nimport FromSurface from './FromSurface';\nimport FromOrbit from './FromOrbit';\nexport default class ManoeuvreControl extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      ship: null,\n      stage: null,\n      celestialBody: null\n    };\n\n    this.fromSurfaceToOrbit = () => {\n      let stage = this.context.state.stage;\n      let requierdDV = Math.sqrt(this.props.ship.celest_body.mu / this.props.ship.celest_body.radius) * 1000 * this.props.ship.celest_body.atmosphere;\n      let dvByStageAfterBurn = [...this.context.state.deltaVByStage];\n      let dvbystage = [...this.context.state.deltaVByStage];\n      let dif = [];\n      console.log('reqDV', requierdDV); // Minus deltaV\n\n      for (let i = 0; i < dvByStageAfterBurn.length; i++) {\n        if (dvByStageAfterBurn[i] > requierdDV) {\n          dvByStageAfterBurn[i] -= requierdDV;\n          requierdDV = 0;\n          console.log('Congratulation, you reach orbit');\n        } else {\n          requierdDV -= dvByStageAfterBurn[i];\n          dvByStageAfterBurn[i] = 0;\n        }\n      }\n\n      if (requierdDV !== 0) {\n        console.log('you failed');\n        return;\n      }\n\n      console.log('dvbystage', dvbystage);\n      console.log('dvByStageAfterBurn', dvByStageAfterBurn); // stage separation\n\n      for (let i = 0; i < dvByStageAfterBurn.length; i++) {\n        if (dvByStageAfterBurn[i] === 0) {\n          stage.splice(0, 1);\n          dvByStageAfterBurn.splice(0, 1);\n          dvbystage.splice(0, 1);\n        }\n      } // getDv % diference\n\n\n      for (let i = 0; i < dvbystage.length; i++) {\n        dif.push(dvByStageAfterBurn[i] / (dvbystage[i] / 100));\n      }\n\n      console.log('dif', dif); // updateFuelLastStage\n\n      for (let i = 0; i < stage[0].tank.length; i++) {\n        stage[0].tank[i].remainingFuel = stage[0].tank[i].remainingFuel / 100 * dif[0] / 1.5;\n      } //stage update\n\n\n      this.context.shipSetStage(stage);\n      this.context.updateLocation('orbit');\n      updateShip(stage, this.props.ship.name, 'orbit', this.props.ship.celest_body.id, this.props.ship.id);\n    };\n\n    this.fromOrbitToSurface = () => {};\n\n    this.escapeFromOrbit = () => {};\n\n    this.childTransfer = () => {};\n  }\n\n  render() {\n    if (this.state.ship.locationStatus === 'orbit') {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ship__control\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(FromOrbit, {\n        fromOrbitToSurface: this.fromOrbitToSurface,\n        escapeFromOrbit: this.escapeFromOrbit,\n        childTransfer: this.childTransfer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }\n      }));\n    } else if (this.state.ship.locationStatus === 'ground') return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ship__control\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(FromSurface, {\n      fromSurfaceToOrbit: this.fromSurfaceToOrbit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(FromOrbit, {\n      fromOrbitToSurface: this.fromOrbitToSurface,\n      escapeFromOrbit: this.escapeFromOrbit,\n      childTransfer: this.childTransfer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\nManoeuvreControl.contextType = ShipContext;","map":{"version":3,"sources":["C:/Users/doubl/Documents/Projets/Try/rocketbuilder/frontend/src/components/controls/ManoeuvreControl.js"],"names":["React","Component","ShipContext","updateShip","FromSurface","FromOrbit","ManoeuvreControl","state","ship","stage","celestialBody","fromSurfaceToOrbit","context","requierdDV","Math","sqrt","props","celest_body","mu","radius","atmosphere","dvByStageAfterBurn","deltaVByStage","dvbystage","dif","console","log","i","length","splice","push","tank","remainingFuel","shipSetStage","updateLocation","name","id","fromOrbitToSurface","escapeFromOrbit","childTransfer","render","locationStatus","contextType"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,WAAT,QAA4B,6BAA5B;AACA,SAASC,UAAT,QAA2B,wBAA3B;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,eAAe,MAAMC,gBAAN,SAA+BL,SAA/B,CAAyC;AAAA;AAAA;AAAA,SACpDM,KADoD,GAC5C;AACJC,MAAAA,IAAI,EAAE,IADF;AAEJC,MAAAA,KAAK,EAAE,IAFH;AAGJC,MAAAA,aAAa,EAAE;AAHX,KAD4C;;AAAA,SAOpDC,kBAPoD,GAO/B,MAAM;AACvB,UAAIF,KAAK,GAAG,KAAKG,OAAL,CAAaL,KAAb,CAAmBE,KAA/B;AACA,UAAII,UAAU,GAAGC,IAAI,CAACC,IAAL,CAAU,KAAKC,KAAL,CAAWR,IAAX,CAAgBS,WAAhB,CAA4BC,EAA5B,GAAiC,KAAKF,KAAL,CAAWR,IAAX,CAAgBS,WAAhB,CAA4BE,MAAvE,IAAiF,IAAjF,GAAwF,KAAKH,KAAL,CAAWR,IAAX,CAAgBS,WAAhB,CAA4BG,UAArI;AACA,UAAIC,kBAAkB,GAAG,CAAC,GAAG,KAAKT,OAAL,CAAaL,KAAb,CAAmBe,aAAvB,CAAzB;AACA,UAAIC,SAAS,GAAG,CAAC,GAAG,KAAKX,OAAL,CAAaL,KAAb,CAAmBe,aAAvB,CAAhB;AACA,UAAIE,GAAG,GAAG,EAAV;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBb,UAArB,EANuB,CAOvB;;AACA,WAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,kBAAkB,CAACO,MAAvC,EAA+CD,CAAC,EAAhD,EAAoD;AAChD,YAAIN,kBAAkB,CAACM,CAAD,CAAlB,GAAwBd,UAA5B,EAAwC;AACpCQ,UAAAA,kBAAkB,CAACM,CAAD,CAAlB,IAAyBd,UAAzB;AACAA,UAAAA,UAAU,GAAG,CAAb;AACAY,UAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;AACH,SAJD,MAIO;AACHb,UAAAA,UAAU,IAAIQ,kBAAkB,CAACM,CAAD,CAAhC;AACAN,UAAAA,kBAAkB,CAACM,CAAD,CAAlB,GAAwB,CAAxB;AACH;AACJ;;AACD,UAAId,UAAU,KAAK,CAAnB,EAAsB;AAClBY,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA;AACH;;AACDD,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBH,SAAzB;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCL,kBAAlC,EAvBuB,CAwBvB;;AACA,WAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,kBAAkB,CAACO,MAAvC,EAA+CD,CAAC,EAAhD,EAAoD;AAChD,YAAIN,kBAAkB,CAACM,CAAD,CAAlB,KAA0B,CAA9B,EAAiC;AAC7BlB,UAAAA,KAAK,CAACoB,MAAN,CAAa,CAAb,EAAgB,CAAhB;AACAR,UAAAA,kBAAkB,CAACQ,MAAnB,CAA0B,CAA1B,EAA6B,CAA7B;AACAN,UAAAA,SAAS,CAACM,MAAV,CAAiB,CAAjB,EAAoB,CAApB;AACH;AACJ,OA/BsB,CAgCvB;;;AACA,WAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,SAAS,CAACK,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACvCH,QAAAA,GAAG,CAACM,IAAJ,CAAST,kBAAkB,CAACM,CAAD,CAAlB,IAAyBJ,SAAS,CAACI,CAAD,CAAT,GAAe,GAAxC,CAAT;AACH;;AACDF,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBF,GAAnB,EApCuB,CAqCvB;;AACA,WAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,KAAK,CAAC,CAAD,CAAL,CAASsB,IAAT,CAAcH,MAAlC,EAA0CD,CAAC,EAA3C,EAA+C;AAC3ClB,QAAAA,KAAK,CAAC,CAAD,CAAL,CAASsB,IAAT,CAAcJ,CAAd,EAAiBK,aAAjB,GAAkCvB,KAAK,CAAC,CAAD,CAAL,CAASsB,IAAT,CAAcJ,CAAd,EAAiBK,aAAjB,GAAiC,GAAjC,GAAuCR,GAAG,CAAC,CAAD,CAA3C,GAAkD,GAAnF;AACH,OAxCsB,CAyCvB;;;AACA,WAAKZ,OAAL,CAAaqB,YAAb,CAA0BxB,KAA1B;AACA,WAAKG,OAAL,CAAasB,cAAb,CAA4B,OAA5B;AACA/B,MAAAA,UAAU,CAACM,KAAD,EAAQ,KAAKO,KAAL,CAAWR,IAAX,CAAgB2B,IAAxB,EAA8B,OAA9B,EAAuC,KAAKnB,KAAL,CAAWR,IAAX,CAAgBS,WAAhB,CAA4BmB,EAAnE,EAAuE,KAAKpB,KAAL,CAAWR,IAAX,CAAgB4B,EAAvF,CAAV;AACH,KApDmD;;AAAA,SAsDpDC,kBAtDoD,GAsD/B,MAAM,CAE1B,CAxDmD;;AAAA,SA0DpDC,eA1DoD,GA0DlC,MAAM,CAEvB,CA5DmD;;AAAA,SA8DpDC,aA9DoD,GA8DpC,MAAM,CAErB,CAhEmD;AAAA;;AAmEpDC,EAAAA,MAAM,GAAG;AACL,QAAI,KAAKjC,KAAL,CAAWC,IAAX,CAAgBiC,cAAhB,KAAmC,OAAvC,EAAgD;AAC5C,0BACI;AAAK,QAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,SAAD;AACI,QAAA,kBAAkB,EAAE,KAAKJ,kBAD7B;AAEI,QAAA,eAAe,EAAE,KAAKC,eAF1B;AAGI,QAAA,aAAa,EAAE,KAAKC,aAHxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADJ;AASH,KAVD,MAUO,IAAI,KAAKhC,KAAL,CAAWC,IAAX,CAAgBiC,cAAhB,KAAmC,QAAvC,EACP,oBACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,WAAD;AACI,MAAA,kBAAkB,EAAE,KAAK9B,kBAD7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAII,oBAAC,SAAD;AACI,MAAA,kBAAkB,EAAE,KAAK0B,kBAD7B;AAEI,MAAA,eAAe,EAAE,KAAKC,eAF1B;AAGI,MAAA,aAAa,EAAE,KAAKC,aAHxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJJ,CADJ;AAYH;;AA3FmD;AA8FxDjC,gBAAgB,CAACoC,WAAjB,GAA+BxC,WAA/B","sourcesContent":["import React, { Component } from 'react';\r\nimport { ShipContext } from '../../contexts/ShipProvider'\r\nimport { updateShip } from '../../utils/updateShip'\r\nimport FromSurface from './FromSurface'\r\nimport FromOrbit from './FromOrbit'\r\nexport default class ManoeuvreControl extends Component {\r\n    state = {\r\n        ship: null,\r\n        stage: null,\r\n        celestialBody: null\r\n    }\r\n\r\n    fromSurfaceToOrbit = () => {\r\n        let stage = this.context.state.stage\r\n        let requierdDV = Math.sqrt(this.props.ship.celest_body.mu / this.props.ship.celest_body.radius) * 1000 * this.props.ship.celest_body.atmosphere\r\n        let dvByStageAfterBurn = [...this.context.state.deltaVByStage]\r\n        let dvbystage = [...this.context.state.deltaVByStage]\r\n        let dif = []\r\n        console.log('reqDV', requierdDV);\r\n        // Minus deltaV\r\n        for (let i = 0; i < dvByStageAfterBurn.length; i++) {\r\n            if (dvByStageAfterBurn[i] > requierdDV) {\r\n                dvByStageAfterBurn[i] -= requierdDV\r\n                requierdDV = 0\r\n                console.log('Congratulation, you reach orbit')\r\n            } else {\r\n                requierdDV -= dvByStageAfterBurn[i]\r\n                dvByStageAfterBurn[i] = 0\r\n            }\r\n        }\r\n        if (requierdDV !== 0) {\r\n            console.log('you failed')\r\n            return\r\n        }\r\n        console.log('dvbystage', dvbystage);\r\n        console.log('dvByStageAfterBurn', dvByStageAfterBurn);\r\n        // stage separation\r\n        for (let i = 0; i < dvByStageAfterBurn.length; i++) {\r\n            if (dvByStageAfterBurn[i] === 0) {\r\n                stage.splice(0, 1)\r\n                dvByStageAfterBurn.splice(0, 1)\r\n                dvbystage.splice(0, 1)\r\n            }\r\n        }\r\n        // getDv % diference\r\n        for (let i = 0; i < dvbystage.length; i++) {\r\n            dif.push(dvByStageAfterBurn[i] / (dvbystage[i] / 100))\r\n        }\r\n        console.log('dif', dif);\r\n        // updateFuelLastStage\r\n        for (let i = 0; i < stage[0].tank.length; i++) {\r\n            stage[0].tank[i].remainingFuel = (stage[0].tank[i].remainingFuel / 100 * dif[0]) / 1.5\r\n        }\r\n        //stage update\r\n        this.context.shipSetStage(stage)\r\n        this.context.updateLocation('orbit')\r\n        updateShip(stage, this.props.ship.name, 'orbit', this.props.ship.celest_body.id, this.props.ship.id)\r\n    }\r\n\r\n    fromOrbitToSurface = () => {\r\n\r\n    }\r\n\r\n    escapeFromOrbit = () => {\r\n\r\n    }\r\n\r\n    childTransfer = () => {\r\n\r\n    }\r\n\r\n\r\n    render() {\r\n        if (this.state.ship.locationStatus === 'orbit') {\r\n            return (\r\n                <div className=\"ship__control\">\r\n                    <FromOrbit\r\n                        fromOrbitToSurface={this.fromOrbitToSurface}\r\n                        escapeFromOrbit={this.escapeFromOrbit}\r\n                        childTransfer={this.childTransfer}\r\n                    />\r\n                </div>\r\n            )\r\n        } else if (this.state.ship.locationStatus === 'ground')\r\n        return (\r\n            <div className=\"ship__control\">\r\n                <FromSurface\r\n                    fromSurfaceToOrbit={this.fromSurfaceToOrbit}\r\n                />\r\n                <FromOrbit\r\n                    fromOrbitToSurface={this.fromOrbitToSurface}\r\n                    escapeFromOrbit={this.escapeFromOrbit}\r\n                    childTransfer={this.childTransfer}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nManoeuvreControl.contextType = ShipContext;\r\n"]},"metadata":{},"sourceType":"module"}